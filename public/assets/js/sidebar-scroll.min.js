(function() { 'use strict'; var supportsScrollBehavior = 'scrollBehavior' in document.documentElement.style; function smoothScrollTo(element, target, duration) { if (supportsScrollBehavior) { element.scrollTo({ top: target, behavior: 'smooth' }); return; } var start = element.scrollTop; var change = target - start; var startTime = performance.now(); function animateScroll(currentTime) { var elapsed = currentTime - startTime; var progress = Math.min(elapsed / duration, 1); var easeOut = 1 - Math.pow(1 - progress, 3); element.scrollTop = start + (change * easeOut); if (progress < 1) { requestAnimationFrame(animateScroll); } } requestAnimationFrame(animateScroll); } function scrollActiveIntoView() { var sidebar = document.querySelector('.sidebar-nav'); var activeItem = document.querySelector('.sidebar-nav .is-active'); if (!sidebar || !activeItem) return; var sidebarRect = sidebar.getBoundingClientRect(); var itemRect = activeItem.getBoundingClientRect(); var isVisible = itemRect.top >= sidebarRect.top && itemRect.bottom <= sidebarRect.bottom; if (!isVisible) { var scrollTop = activeItem.offsetTop - sidebar.offsetTop - (sidebar.clientHeight / 2) + (activeItem.clientHeight / 2); scrollTop = Math.max(0, Math.min(scrollTop, sidebar.scrollHeight - sidebar.clientHeight)); smoothScrollTo(sidebar, scrollTop, 300); } } function init() { if (document.readyState === 'loading') { document.addEventListener('DOMContentLoaded', scrollActiveIntoView); } else { scrollActiveIntoView(); } document.addEventListener('click', function(e) { var link = e.target.closest('.sidebar-nav a'); if (!link) return; var allLinks = document.querySelectorAll('.sidebar-nav a'); for (var i = 0; i < allLinks.length; i++) { allLinks[i].classList.remove('is-active'); } link.classList.add('is-active'); setTimeout(scrollActiveIntoView, 100); }); document.addEventListener('keydown', function(e) { var activeItem = document.querySelector('.sidebar-nav .is-active'); if (!activeItem) return; var allLinks = Array.prototype.slice.call(document.querySelectorAll('.sidebar-nav a')); var currentIndex = allLinks.indexOf(activeItem); var newIndex = currentIndex; if (e.key === 'ArrowUp' && currentIndex > 0) { newIndex = currentIndex - 1; e.preventDefault(); } else if (e.key === 'ArrowDown' && currentIndex < allLinks.length - 1) { newIndex = currentIndex + 1; e.preventDefault(); } if (newIndex !== currentIndex) { allLinks[currentIndex].classList.remove('is-active'); allLinks[newIndex].classList.add('is-active'); allLinks[newIndex].focus(); scrollActiveIntoView(); } }); } init(); window.SidebarScroll = { scrollActiveIntoView: scrollActiveIntoView, smoothScrollTo: smoothScrollTo }; })();