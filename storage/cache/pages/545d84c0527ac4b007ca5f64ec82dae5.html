        </main>
    </div>


    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="/ergon/public/assets/js/sidebar-scroll.min.js?v=" defer></script>
    <script>
    function toggleSidebar() {
        const sidebar = document.querySelector('.sidebar');
        sidebar.classList.toggle('sidebar--open');
    }
    
    function toggleTheme() {
        var currentTheme = document.body.getAttribute('data-theme') || 'light';
        var newTheme = currentTheme === 'light' ? 'dark' : 'light';
        document.body.setAttribute('data-theme', newTheme);
        var themeIcon = document.getElementById('themeIcon');
        if (themeIcon) themeIcon.textContent = newTheme === 'dark' ? '‚òÄÔ∏è' : 'üåô';
        
        fetch('/ergon/api/update-preference', {
            method: 'POST',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify({key: 'theme', value: newTheme})
        }).catch(function(error) { console.log('Theme save failed:', error); });
    }
    
    function toggleNotifications() {
        var dropdown = document.getElementById('notificationDropdown');
        if (dropdown) {
            dropdown.style.display = dropdown.style.display === 'block' ? 'none' : 'block';
        }
    }
    
    function toggleProfile() {
        var menu = document.getElementById('profileMenu');
        if (menu) {
            menu.style.display = menu.style.display === 'block' ? 'none' : 'block';
        }
    }
    
    // Smooth scroll to active item only if not visible
    const activeItem = document.querySelector('.sidebar__link--active, .sidebar__link.is-active');
    if (activeItem) {
        const sidebar = document.querySelector('.sidebar');
        const sidebarRect = sidebar.getBoundingClientRect();
        const itemRect = activeItem.getBoundingClientRect();
        
        // Only scroll if item is not visible
        if (itemRect.top < sidebarRect.top || itemRect.bottom > sidebarRect.bottom) {
            activeItem.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }
    }
    
    // Prevent forced focus jump
    document.querySelectorAll('.sidebar__link').forEach(a => {
        a.addEventListener('focus', e => {
            e.preventDefault();
            a.blur();
        });
    });
    
    // Close dropdowns when clicking outside
    document.addEventListener('click', function(e) {
        const sidebar = document.querySelector('.sidebar');
        const toggle = document.querySelector('.mobile-menu-toggle');
        const profileBtn = document.querySelector('.sidebar__profile-btn');
        const notificationBtn = document.querySelector('.sidebar__control-btn');
        
        // Close sidebar on mobile
        const sidebarEl = document.querySelector('.sidebar');
        if (window.innerWidth <= 768 && sidebarEl && !sidebarEl.contains(e.target) && toggle && !toggle.contains(e.target)) {
            sidebarEl.classList.remove('sidebar--open');
        }
        
        // Close profile menu
        if (profileBtn && !profileBtn.contains(e.target)) {
            var menu = document.getElementById('profileMenu');
            if (menu) menu.style.display = 'none';
        }
        
        // Close notification dropdown
        if (notificationBtn && !notificationBtn.contains(e.target)) {
            var dropdown = document.getElementById('notificationDropdown');
            if (dropdown) dropdown.style.display = 'none';
        }
    });
    </script>
</body>
</html>